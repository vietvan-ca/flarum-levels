{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@vietvan-ca/flarum-levels/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@vietvan-ca/flarum-levels/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@vietvan-ca/flarum-levels/./src/forum/components/UserLevelDisplay.js","webpack://@vietvan-ca/flarum-levels/./src/forum/index.js","webpack://@vietvan-ca/flarum-levels/external root \"flarum.core.compat['common/Component']\"","webpack://@vietvan-ca/flarum-levels/external root \"flarum.core.compat['common/Model']\"","webpack://@vietvan-ca/flarum-levels/external root \"flarum.core.compat['common/extend']\"","webpack://@vietvan-ca/flarum-levels/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@vietvan-ca/flarum-levels/external root \"flarum.core.compat['common/models/User']\"","webpack://@vietvan-ca/flarum-levels/external root \"flarum.core.compat['forum/app']\"","webpack://@vietvan-ca/flarum-levels/external root \"flarum.core.compat['forum/components/PostUser']\"","webpack://@vietvan-ca/flarum-levels/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@vietvan-ca/flarum-levels/webpack/bootstrap","webpack://@vietvan-ca/flarum-levels/webpack/runtime/compat get default export","webpack://@vietvan-ca/flarum-levels/webpack/runtime/define property getters","webpack://@vietvan-ca/flarum-levels/webpack/runtime/hasOwnProperty shorthand","webpack://@vietvan-ca/flarum-levels/webpack/runtime/make namespace object"],"sourcesContent":["import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\nimport icon from 'flarum/common/helpers/icon';\n\nexport default class UserLevelDisplay extends Component {\n  view() {\n    const user = this.attrs.user;\n    const level = user.level();\n    \n    if (!level) return null;\n    \n    const levelColor = level.color || '#0072ff';\n    \n    return (\n      <div className=\"UserLevelDisplay\">\n        <div className=\"UserLevel-badge\" style={{ backgroundColor: levelColor }}>\n          {level.icon && icon(level.icon)}\n          <span className=\"UserLevel-name\">\n            {app.translator.trans('vietvan-ca-flarum-levels.forum.user.level_badge', { name: level.name })}\n          </span>\n        </div>\n      </div>\n    );\n  }\n  \n  getNextLevel(user) {\n    const currentLevelXP = user.level().xp_required;\n    \n    // Get all standard levels (not special)\n    const levels = app.store.all('levels')\n      .filter(l => !l.is_special)\n      .sort((a, b) => a.xp_required - b.xp_required);\n    \n    // Find the next level after the current one\n    const nextLevel = levels.find(l => l.xp_required > currentLevelXP);\n    \n    return nextLevel || null;\n  }\n  \n  calculateProgress(user, currentLevel, nextLevel) {\n    if (!nextLevel) return 100;\n    \n    const currentXP = user.xp();\n    const levelStartXP = currentLevel.xp_required;\n    const levelEndXP = nextLevel.xp_required;\n    \n    const progressXP = currentXP - levelStartXP;\n    const totalXPNeeded = levelEndXP - levelStartXP;\n    \n    return Math.min(Math.floor((progressXP / totalXPNeeded) * 100), 100);\n  }\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport PostUser from 'flarum/forum/components/PostUser';\nimport Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\nimport UserLevelDisplay from './components/UserLevelDisplay';\n\napp.initializers.add('vietvan-ca-levels', () => {\n  // Add level attributes to User model\n  User.prototype.xp = Model.attribute('xp');\n  User.prototype.level = Model.attribute('level');\n  User.prototype.isManualLevel = Model.attribute('is_manual_level');\n  \n  // Add level badge to user cards\n  extend(UserCard.prototype, 'infoItems', function(items) {\n    const user = this.attrs.user;\n    const level = user.level();\n    \n    if (level) {\n      items.add('level', <UserLevelDisplay user={user} />, 10);\n    }\n  });\n  \n  // Add level to discussion posts (this is what you're missing)\n  extend(PostUser.prototype, 'view', function(vdom) {\n    // Find the user's level\n    const user = this.attrs.post.user();\n    if (!user || !user.level()) return;\n    \n    const level = user.level();\n    \n    // Create level badge element\n    const levelBadge = (\n      <span \n        className=\"PostUser-level\" \n        style={level.color ? {backgroundColor: level.color} : {}}\n        title={level.description || ''}\n      >\n        {level.name}\n      </span>\n    );\n    \n    // If vdom is an array of elements\n    if (Array.isArray(vdom.children)) {\n      // Find where to insert the level badge (after username)\n      // Usually after the first or second element depending on your theme\n      if (vdom.children.length > 1) {\n        // Insert after username\n        vdom.children.splice(2, 0, levelBadge);\n      } else {\n        // Append at the end\n        vdom.children.push(levelBadge);\n      }\n    }\n  });\n});","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/helpers/icon'];","module.exports = flarum.core.compat['common/models/User'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/PostUser'];","module.exports = flarum.core.compat['forum/components/UserCard'];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"names":["setPrototypeOf","_inheritsLoose","t","o","prototype","Object","create","constructor","default","_setPrototypeOf","e","bind","__proto__","app","Component","icon","UserLevelDisplay","_Component","apply","arguments","_proto","view","user","attrs","level","levelColor","color","m","className","style","backgroundColor","translator","trans","name","getNextLevel","currentLevelXP","xp_required","levels","store","all","filter","l","is_special","sort","a","b","nextLevel","find","calculateProgress","currentLevel","currentXP","xp","levelStartXP","levelEndXP","progressXP","totalXPNeeded","Math","min","floor","extend","UserCard","PostUser","Model","User","initializers","add","attribute","isManualLevel","items","vdom","post","levelBadge","title","description","Array","isArray","children","length","splice","push"],"sourceRoot":""}